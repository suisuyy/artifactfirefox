
function runAiArtifactbeta() {
  console.log('runAiArtifactbeta');
let zindex='100000000';
let fetch=cfetch;


function getCodeBlocks(){const e=document.querySelectorAll("code"),t={};return e.forEach((e=>{const n=e.textContent.trim(),o=getFilename(n);o&&(t[o]=n)})),t}function getFilename(e){const t=e.split("\n")[0].trim();if(t){const e=t.match(/<!--\s*(.*?)\s*-->/)||t.match(/\/\/\s*(.*?)\s*$/)||t.match(/\/\*\s*(.*?)\s*\*\//);return console.log("First line:",t),console.log("Match result:",e),e?e[1]:null}return console.log("First line is empty or whitespace."),null}function getIdFromUrl(e=window.location.href){return e.replace(/[^a-zA-Z0-9]/g,"")}function extractCodeData(){const e=getCodeBlocks(),t=getIdFromUrl(),n=Object.keys(e).find((e=>e.endsWith(".html")));if(n){const t="\n\n      <script type=\"module\" src=\"https://appstore.suisuy.eu.org/httpschatgptcomcb40f8c3c304c4aa287938b0e5ec242a2showerror/showerror.js\">\n      <\/script>\n      <script>\n        const urlParams = new URLSearchParams(window.location.search);\n        const debugMode = urlParams.get('debug') === 'true';\n\n        if (debugMode) {\n          const script = document.createElement('script');\n          script.src = '//cdn.jsdelivr.net/npm/eruda';\n          document.head.appendChild(script);\n          script.onload = () => {\n          eruda.init();\n          //eruda.show()\n          let erudaconsole = eruda.get('console');\n          erudaconsole.config.set('catchGlobalErr', true);\n          erudaconsole.config.set('displayIfErr', true);\n          erudaconsole.config.set('lazyEvaluation', true);\n\n\n          };\n\n          }\n      <\/script>\n      ";e[n]=e[n].replace("</head>",`${t}</head>`)}return{id:t,...e}}function makeContainerDraggable(e,t){let n,o=0,r=0,l=0,s=0,i=!1;const c=document.createElement("div");function d(t){t.preventDefault(),i=!0,o=l-t.clientX,r=s-t.clientY,l=t.clientX,s=t.clientY,e.style.top=e.offsetTop-r+"px",e.style.left=e.offsetLeft-o+"px"}function a(t){t.preventDefault(),i=!0;const n=t.touches[0];o=l-n.clientX,r=s-n.clientY,l=n.clientX,s=n.clientY,e.style.top=e.offsetTop-r+"px",e.style.left=e.offsetLeft-o+"px"}function u(){document.removeEventListener("mouseup",u),document.removeEventListener("mousemove",d),document.removeEventListener("touchend",u),document.removeEventListener("touchmove",a),clearTimeout(n),i?(i=!1,setTimeout((()=>{c.style.display="none"}),0)):c.style.display="none"}c.style.position="fixed",c.style.top="0",c.style.left="0",c.style.width="100%",c.style.height="100%",c.style.backgroundColor="rgba(0, 0, 0, 0.1)",c.style.zIndex="10000",c.style.display="none",document.body.appendChild(c),t.addEventListener("mousedown",(function(e){e.preventDefault(),l=e.clientX,s=e.clientY,document.addEventListener("mouseup",u),document.addEventListener("mousemove",d),n=setTimeout((()=>{c.style.display="block"}),500)})),t.addEventListener("touchstart",(function(e){e.preventDefault();const t=e.touches[0];l=t.clientX,s=t.clientY,document.addEventListener("touchend",u),document.addEventListener("touchmove",a),n=setTimeout((()=>{c.style.display="block"}),500)}))}function setButtonStyles(e,t=!1){e.style.backgroundColor=t?"#ADD8E6":"transparent",e.style.color=t?"#000":"white",e.style.border=t?"1px solid #ADD8E6":"none",e.style.cursor="pointer",e.style.marginLeft="5px",e.style.padding="5px 10px",e.style.borderRadius="5px",e.style.fontSize="14px"}function setTabStyles(e){e.style.cursor="pointer",e.style.padding="10px",e.style.border="none",e.style.backgroundColor="#f1f1f1",e.style.marginRight="5px",e.style.display="inline-block",e.style.borderBottom="2px solid transparent"}function fetchAndDisplaySourceList(e){fetch(`https://appstore.suisuy.workers.dev/${e}`).then((e=>e.json())).then((t=>{const n=document.querySelector("#tabs-container"),o=document.querySelector("#source-container");n.innerHTML="",o.innerHTML="";let r=0;const l=document.createElement("button");l.textContent="Copy All Code",setButtonStyles(l,!0),l.addEventListener("click",copyAllCodeToClipboard),o.appendChild(l),t.forEach(((t,s)=>{const i=document.createElement("button");fetch(`https://appstore.suisuy.workers.dev/${e}/${t}`).then((e=>e.text())).then((c=>{const d=c.split("\n").length;r+=d,i.textContent=`${t} (${d})`,l.textContent=`Copy All Code (${r} lines)`,setTabStyles(i);const a=document.createElement("div");a.id=`file-content-${s}`,a.style.marginBottom="20px";const u=document.createElement("h3");u.textContent=t,a.appendChild(u);const p=document.createElement("pre");p.dataset.filename=t,a.appendChild(p),fetchAndDisplaySource(e,t,p),i.addEventListener("click",(()=>{document.getElementById(`file-content-${s}`).scrollIntoView({behavior:"smooth"}),n.childNodes.forEach((e=>{e.style.borderBottom="2px solid transparent"})),i.style.borderBottom="2px solid #007BFF"})),n.appendChild(i),o.appendChild(a)})).catch((e=>{console.error(`Error fetching file content for ${t}:`,e)}))})),n.firstChild&&n.firstChild.click()})).catch((e=>{console.error("Error fetching file list:",e)}))}function fetchAndDisplaySource(e,t,n){fetch(`https://appstore.suisuy.workers.dev/${e}/${t}`).then((e=>e.text())).then((e=>{if(t.endsWith(".html"))n.textContent=e;else{const t=e.split("\n").map(((e,t)=>`<span class="line-number" contenteditable="false" style="display: inline-block; width: 30px; text-align: right; margin-right: 10px; color: #888; user-select: none;">${t+1}</span> ${e}`)).join("\n");n.innerHTML=t}})).catch((e=>{console.error(`Error fetching file content for ${t}:`,e)}))}function copyAllCodeToClipboard(){const e=document.querySelector("#source-container").querySelectorAll("pre");let t="";e.forEach((e=>{const n=e.dataset.filename;t+=`// ${n}\n`,n.endsWith(".html")?t+=`${e.textContent}\n\n`:(e.querySelectorAll(".line-number").forEach((e=>e.style.display="none")),t+=`${e.textContent}\n\n`,e.querySelectorAll(".line-number").forEach((e=>e.style.display="inline-block")))}));const n=document.createElement("textarea");n.value=t,document.body.appendChild(n),n.select();try{document.execCommand("copy"),console.log("All code copied to clipboard.")}catch(e){console.error("Error copying code to clipboard:",e)}document.body.removeChild(n)}function addButtonEventListener(e,t){e.addEventListener("click",t),e.addEventListener("touchstart",(e=>{e.preventDefault(),t(e)}))}function setupButtonHandlers({container:e,topBar:t,urlInput:n,iframe:o,sourceContainer:r,tabsContainer:l}){const s=document.createElement("button");s.textContent="âœ–ï¸",setButtonStyles(s),addButtonEventListener(s,(()=>{e.style.display="none";document.querySelector("#toggle-button").textContent="âœ¨"}));const i=document.createElement("button");i.textContent="ðŸ”",setButtonStyles(i);let c=!1;addButtonEventListener(i,(()=>{c?(e.style.width="400px",o.style.height="300px",i.textContent="ðŸ”"):(e.style.width="800px",o.style.height="600px",i.textContent="ðŸ”Ž"),c=!c}));const d=document.createElement("button");d.textContent="ðŸ”—",setButtonStyles(d),addButtonEventListener(d,(()=>{"none"===n.style.display?(n.style.display="block",d.textContent="ðŸ”—"):(n.style.display="none",d.textContent="ðŸ”—")}));const a=document.createElement("button");a.textContent="ðŸ“œ",setButtonStyles(a),addButtonEventListener(a,(()=>{if("none"===l.style.display){l.style.display="block",r.style.display="block",o.style.display="none",a.textContent="ðŸ“œ";fetchAndDisplaySourceList(getIdFromUrl())}else l.style.display="none",r.style.display="none",o.style.display="block",a.textContent="ðŸ“œ"}));const u=document.createElement("button");u.textContent="ðŸ”„",setButtonStyles(u),u.id="refresh-button",addButtonEventListener(u,(()=>{u.textContent="ðŸ”„ Refreshing...";const e=extractCodeData();fetch("https://appstore.suisuy.workers.dev/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((()=>{createIframeAndUrl(e.id),u.textContent="ðŸ”„"})).catch((e=>{console.error("Error sending code data to server:",e),u.textContent="ðŸ”„"}))}));const p=document.createElement("button");p.textContent="â“",setButtonStyles(p),addButtonEventListener(p,(()=>{o.src="https://appstore.suisuy.workers.dev/httpschatgptcomca5968c9855df47dc949ae009b42c73f6/index.html",n.value=o.src})),t.appendChild(s),t.appendChild(i),t.appendChild(d),t.appendChild(a),t.appendChild(u),t.appendChild(p),e.appendChild(t)}function setContainerStyle(e){e.style.position="fixed",e.style.top="10px",e.style.right="10px",e.style.width="400px",e.style.border="1px solid #ccc",e.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.5)",e.style.zIndex="2147483647",e.style.backgroundColor="white",e.style.borderRadius="5px",e.style.overflow="hidden",e.style.color="black"}function setTopBarStyle(e){e.style.backgroundColor="#ADD8E6",e.style.padding="5px",e.style.cursor="move",e.style.textAlign="left",e.style.position="relative",e.style.color="white",e.style.display="flex",e.style.alignItems="center"}function setIframeStyle(e){e.width="100%",e.height="60vh",e.style.minHeight="400px",e.style.border="none"}function setUrlInputStyle(e){e.style.padding="5px",e.style.margin="0",e.style.backgroundColor="#f9f9f9",e.style.borderTop="1px solid #ccc",e.style.width="100%",e.style.color="black"}function setTabsContainerStyle(e){e.style.display="none",e.style.padding="5px",e.style.backgroundColor="#f1f1f1",e.style.borderTop="1px solid #ccc",e.style.overflowX="auto",e.style.whiteSpace="nowrap",e.style.position="sticky",e.style.top="0"}function setSourceContainerStyle(e){e.style.display="none",e.style.padding="10px",e.style.backgroundColor="#f9f9f9",e.style.overflowY="auto",e.style.maxHeight="600px"}function setCopyButtonStyle(e){e.style.marginBottom="10px",e.style.padding="10px",e.style.cursor="pointer",e.style.backgroundColor="#007BFF",e.style.color="white",e.style.border="none",e.style.borderRadius="5px"}function injectErudaIntoIframe(e){"true"===new URLSearchParams(window.location.search).get("debug")&&e.addEventListener("load",(()=>{const t=e.ownerDocument.createElement("script");t.src="//cdn.jsdelivr.net/npm/eruda",t.onload=()=>{e.contentWindow.eruda.init()},e.ownerDocument.head.appendChild(t)}))}function createIframeAndUrl(e){e=getIdFromUrl();let t=document.querySelector("#iframe-container"),n=document.querySelector("#code-displayer"),o=document.querySelector("#url-input"),r=document.querySelector("#top-bar"),l=document.querySelector("#source-container"),s=document.querySelector("#tabs-container");if(!t){if(t=document.createElement("div"),t.id="iframe-container",setContainerStyle(t),r=document.createElement("div"),r.id="top-bar",setTopBarStyle(r),n||(n=document.createElement("iframe"),n.id="code-displayer",setIframeStyle(n),injectErudaIntoIframe(n)),o||(o=document.createElement("input"),o.id="url-input",o.type="text",setUrlInputStyle(o),o.addEventListener("change",(()=>{n.src=o.value}))),s||(s=document.createElement("div"),s.id="tabs-container",setTabsContainerStyle(s)),!l){l=document.createElement("div"),l.id="source-container",setSourceContainerStyle(l);const e=document.createElement("button");e.textContent="Copy All Code",setCopyButtonStyle(e),e.addEventListener("click",copyAllCodeToClipboard2),l.appendChild(e)}setupButtonHandlers({container:t,topBar:r,urlInput:o,iframe:n,sourceContainer:l,tabsContainer:s}),t.appendChild(r),t.appendChild(n),t.appendChild(o),t.appendChild(s),t.appendChild(l),document.body.appendChild(t),makeContainerDraggable(t,r)}fetch(`https://appstore.suisuy.eu.org/${e}`).then((e=>e.json())).then((r=>{if(!Array.isArray(r)||0===r.length)return console.error("No files found or error fetching files."),void(t.style.display="none");let l="";if(r.includes("index.html"))l=`https://appstore.suisuy.eu.org/${e}/index.html`;else{const n=r.filter((e=>e.endsWith(".html")));if(!(n.length>0))return console.error("No HTML files found for display."),void(t.style.display="none");l=`https://appstore.suisuy.eu.org/${e}/${n[0]}`}n.src=l,o.value=l,t.style.display="block"})).catch((e=>{console.error("Error fetching files:",e),t.style.display="none"}))}function copyAllCodeToClipboard2(){const e=document.querySelector("#source-container").querySelectorAll("pre");let t="";e.forEach((e=>{t+=e.textContent+"\n"})),navigator.clipboard.writeText(t).then((()=>{console.log("All code copied to clipboard.")})).catch((e=>{console.error("Error copying code to clipboard:",e)}))}var previousCodeData=null;function handleToggleButtonClick(){const e=document.querySelector("#iframe-container"),t=document.querySelector("#toggle-button"),n=extractCodeData();e&&"block"===e.style.display?(e.style.display="none",t.textContent="âœ¨"):JSON.stringify(previousCodeData)===JSON.stringify(n)?(e.style.display="block",t.textContent="ðŸª„"):(previousCodeData=n,fetch("https://appstore.suisuy.eu.org/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((()=>{createIframeAndUrl(n.id),t.textContent="ðŸª„"})))}function initializeToggleButton(){const e=document.createElement("button");e.id="toggle-button",e.textContent="âœ¨",setButtonStyles(e),e.style.position="fixed",e.style.top="50%",e.style.right="10px",e.style.transform="translateY(-50%)",e.style.zIndex="1000",e.style.padding="10px",e.style.backgroundColor="#ffffff",e.style.color="#007BFF",e.style.border="2px solid #007BFF",e.style.borderRadius="50%",e.style.cursor="pointer",e.style.boxShadow="0px 0px 10px rgba(0, 0, 0, 0.1)",e.style.fontSize="24px",e.addEventListener("click",handleToggleButtonClick),document.body.appendChild(e)}function initializeErrorLog(){if("true"===new URLSearchParams(window.location.search).get("debug")){const e=document.createElement("script");e.src="//cdn.jsdelivr.net/npm/eruda",e.onload=()=>eruda.init(),document.head.appendChild(e)}}var refreshTimeout,previousCodeData2=null,isRefreshing=!1;function handleRefresh(){if(isRefreshing)return;const e=extractCodeData();if(JSON.stringify(previousCodeData2)===JSON.stringify(e))return void console.log("No changes detected in code data. Skipping refresh.");isRefreshing=!0,previousCodeData2=e;const t=document.querySelector("#refresh-button");t&&(t.style.backgroundColor="black",t.style.color="white"),fetch("https://appstore.suisuy.workers.dev/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then((()=>{createIframeAndUrl(e.id),t&&(t.style.backgroundColor="transparent",t.style.color="white"),isRefreshing=!1})).catch((e=>{console.error("Error refreshing iframe:",e),t&&(t.style.backgroundColor="transparent",t.style.color="white"),isRefreshing=!1}))}function setupMutationObserver(){const e=document.documentElement;new MutationObserver((e=>{for(const t of e)"childList"===t.type&&(console.log("DOM mutation detected: child node added or removed."),handleMutation())})).observe(e,{childList:!0,subtree:!0})}function handleMutation(){clearTimeout(refreshTimeout),refreshTimeout=setTimeout((()=>{handleRefresh()}),3e3)}function setupConsoleLogging(){"true"===new URLSearchParams(window.location.search).get("debug")||(console.log=function(){})}function initialize(){initializeToggleButton(),initializeErrorLog(),setupMutationObserver(),setupConsoleLogging()}initialize();


}
